{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "DTLR Repository Governance Manifest",
  "description": "Configuration for governance submodules and templating",
  "type": "object",
  "required": ["governance", "repository"],
  "properties": {
    "governance": {
      "type": "object",
      "required": ["versions"],
      "properties": {
        "versions": {
          "type": "object",
          "properties": {
            "core": { "type": "string", "pattern": "^v\\d+\\.\\d+\\.\\d+$" },
            "iac": { "type": "string", "pattern": "^v\\d+\\.\\d+\\.\\d+$" },
            "terraform": { "type": "string", "pattern": "^v\\d+\\.\\d+\\.\\d+$" },
            "app": { "type": "string", "pattern": "^v\\d+\\.\\d+\\.\\d+$" }
          }
        }
      }
    },
    "repository": {
      "type": "object",
      "required": ["name", "type"],
      "properties": {
        "name": { "type": "string" },
        "type": {
          "type": "string",
          "enum": ["multi-cloud-iac", "single-cloud-iac", "application", "library", "pipeline"]
        },
        "description": { "type": "string" },
        "primary_language": { "type": "string" }
      }
    },
    "template_vars": {
      "type": "object",
      "description": "Variables passed to Jinja2 templates",
      "additionalProperties": true
    },
    "compliance": {
      "type": "object",
      "description": "Compliance flags for governance rules",
      "properties": {
        "enforce_saved_plans": { "type": "boolean" },
        "enforce_validation": { "type": "boolean" },
        "enforce_state_cache": { "type": "boolean" },
        "require_issue_tracking": { "type": "boolean" },
        "require_pr_reviews": { "type": "boolean" }
      }
    },
    "custom_rules": {
      "type": "array",
      "description": "Repo-specific overrides or additions",
      "items": { "type": "string" }
    }
  }
}
